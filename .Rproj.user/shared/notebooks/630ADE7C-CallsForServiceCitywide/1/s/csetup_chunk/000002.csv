"0","curr.year <- as.numeric(format(Sys.Date(), '%Y')) ### This current year to automatically reference the current year"
"0","begindate <- paste0(curr.year, '-01-01') ### For CFS to automatically create the begindate based on current year"
"0","library(knitr)"
"0","library(flexdashboard)"
"0","library(tidyverse)"
"0","library(jsonlite)"
"0","library(treemap)"
"0","library(d3treeR)"
"0","library(leaflet)"
"0","library(plotly)"
"0","library(forcats)"
"0","opts_chunk$set(echo = FALSE)"
"0","source(""Y:/Projects/dashboard/RPDCrimeDashboard/Functions/LERMS_getCallsForService.R"")"
"0","source(""Y:/Projects/dashboard/RPDCrimeDashboard/Functions/CFSloc.R"")"
"0","source(""Y:/Projects/dashboard/RPDCrimeDashboard/Functions/aoristicDayWeek.R"")"
"0","source(""Y:/Projects/dashboard/RPDCrimeDashboard/Functions/cfsHotspotMap.R"")"
"0","source(""Y:/Projects/dashboard/RPDCrimeDashboard/Functions/plotlyhmap.R"")"
"0","source(""Y:/Projects/dashboard/RPDCrimeDashboard/Functions/nestedbeattable.R"")"
"0","#sevenDayGroupTable is a lookup table to get the current week (Group) from the date"
"0","#Because it uses length(Date) from seq.Date, it should work even in leap years"
"0","sevenDayGroupTable <- data.frame(Date = seq.Date(from = as.Date(begindate),"
"0","                                                 to = as.Date(paste0(curr.year, ""-12-31"")),"
"0","                                                 by = 1)) %>%"
"0","    mutate(DOY = 1:length(Date),"
"0","           Group = c(rep(1:51, each = 7), "
"0","                     rep(52, times = length(Date) - 357)))"
"0","curr.week <- sevenDayGroupTable$Group[match(as.numeric(format(Sys.Date(), "
"0","                                                             '%j')), "
"0","                                           sevenDayGroupTable$DOY)] - 1"
"0","# Read in city map"
"0","citymap <- readRDS(file = ""Z:/Projects/dashboard/RPDCrimeDashboard/Objects/citymap.RDS"")"
"0","loc <- CFSloc()"
"0","exclude <- c(""630 North Clinton Ave, Rochester, NY, 14605"", "
"0","             ""185 Exchange Blvd, Rochester, NY, 14614"","
"0","             ""1099 Jay St, Rochester, NY, 14611"")"
"0","cfs.df <- readRDS(file = ""Z:/Projects/dashboard/RPDCrimeDashboard/Objects/citywidecfs.RDS"")"
