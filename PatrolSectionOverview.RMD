---
title: "Patrol Sections Overview, as of `r format(Sys.Date() - 5, '%d %B, %Y')`"
output: 
  flexdashboard::flex_dashboard:
    logo: Y:/Projects/dashboard/RPDCrimeDashboard/Objects/RPDLogoSMALL.png
    orientation: column
    vertical_layout: fill
    theme: cerulean

---


```{r loaddata}

curr.year <- as.numeric(format(Sys.Date(), '%Y')) ### This current year to automatically reference the current year
begindate <- paste0(curr.year, '-01-01') ### For CFS to automatically create the begindate based on current year

library(tidyverse)
library(stringr)
library(knitr)
library(flexdashboard)
library(RColorBrewer)
library(plotly)
library(leaflet)
library(reshape2)
library(jsonlite)
library(DT)
library(RODBC)
library(mapview) #for cool popups
library(leaflet.extras) #for popups in GeoJSON objects

source("Y:/Projects/dashboard/RPDCrimeDashboard/Functions/LERMS_incidents.R")
source("Y:/Projects/dashboard/RPDCrimeDashboard/Functions/SPC.R")
source("Y:/Projects/dashboard/RPDCrimeDashboard/Functions/pullMCUdata.R")
source("Y:/Projects/dashboard/RPDCrimeDashboard/Functions/loadshootingvictims.R")


overviewmapfunc <- function(daddyJSON, 
                            lakeSPC, 
                            geneseeSPC, 
                            goodmanSPC, 
                            clintonSPC, 
                            centralSPC,
                            linkhash,
                            citymap,
                            sec) {
    babyJSON <- daddyJSON
    crimediff <- data_frame("Section" = sec,
                            "Difference" = c(lakeSPC[[2]] - lakeSPC[[3]],
                                             geneseeSPC[[2]] - geneseeSPC[[3]],
                                             goodmanSPC[[2]] - goodmanSPC[[3]],
                                             clintonSPC[[2]] - clintonSPC[[3]],
                                             centralSPC[[2]] - centralSPC[[3]])
                            ) %>%
        mutate(fillOpacity = abs(Difference / 100),
               fillColor = case_when(.$Difference > 0 ~ "Red",
                                     .$Difference < 0 ~ "Green",
                                     TRUE ~ "White"))
    
    crimediff <- crimediff[match(lapply(babyJSON$features, 
                                        function(x) x$properties$Section) %>% 
                                     unlist(), 
                                 crimediff$Section),]
    babyJSON$features <- lapply(
        babyJSON$features, function(x) {
            x$properties$style <- list(
                fillColor = crimediff$fillColor[which(
                    crimediff$Section == x$properties$Section)],
                fillOpacity = crimediff$fillOpacity[which(
                    crimediff$Section == x$properties$Section)]
            )
            x
        }
    )
    
    links <- data_frame(Section = sec,
                        link = c(paste0('<a href="file://rpdfs.cor.local/mcac$/MCAC Operations/Crime Dashboards/LakeCrimeDashboard.html',
                                       linkhash, 
                                       '">Lake Section Dashboard</a>'), 
                                 paste0('<a href="file://rpdfs.cor.local/mcac$/MCAC Operations/Crime Dashboards/GeneseeCrimeDashboard.html',
                                       linkhash, 
                                       '">Genesee Section Dashboard</a>'), 
                                 paste0('<a href="file://rpdfs.cor.local/mcac$/MCAC Operations/Crime Dashboards/GoodmanCrimeDashboard.html',
                                       linkhash, 
                                       '">Goodman Section Dashboard</a>'), 
                                 paste0('<a href="file://rpdfs.cor.local/mcac$/MCAC Operations/Crime Dashboards/ClintonCrimeDashboard.html',
                                       linkhash, 
                                       '">Clinton Section Dashboard</a>'), 
                                 paste0('<a href="file://rpdfs.cor.local/mcac$/MCAC Operations/Crime Dashboards/CentralCrimeDashboard.html',
                                       linkhash, 
                                       '">Central Section Dashboard</a>')))
    
    babyJSON$features <- lapply(babyJSON$features, function(x) {
        
        x$properties$popup = links$link[which(links$Section == x$properties$Section)]
        x
    })
    
    return(citymap %>%
               addGeoJSON(
                   babyJSON
               ) %>%
               addGeoJSONv2(
                   babyJSON,
                   fillOpacity = 0,
                   popupProperty = "popup",
                   labelProperty = "Section"
               ))
    
}

simpleCap <- function(x) {
  s <- strsplit(x, " ")[[1]]
  paste(toupper(substring(s, 1,1)), tolower(substring(s, 2)),
      sep="", collapse=" ")
}

daddyJSON <- readLines("https://opendata.arcgis.com/datasets/772f3621fa354ec9abf3ba33f3ace59e_0.geojson") %>%
    paste(collapse = "\n") %>%
    fromJSON(simplifyVector = FALSE)
#gather section names and set color palettes for sections and beats
secNames <- sapply(daddyJSON$features, function(x) x$properties$Section)
sectionpal <- colorFactor(palette = colorspace::sequential_hcl(5),
                   domain = secNames)

citymap <- leaflet() %>% #Create city base map
    addProviderTiles("CartoDB.Positron") %>% 
    fitBounds(lng1 = -77.55, lat1 = 43.11, lng2 = -77.668684, lat2 = 43.264020)


#sevenDayGroupTable is a lookup table to get the current week (Group) from the date
#Because it uses length(Date) from seq.Date, it should work even in leap years

sevenDayGroupTable <- data.frame(Date = seq.Date(from = as.Date(begindate),
                                                 to = as.Date(paste0(curr.year, "-12-31")),
                                                 by = 1)) %>%
    mutate(DOY = 1:length(Date),
           Group = c(rep(1:51, each = 7), 
                     rep(52, times = length(Date) - 357)))

curr.week <- sevenDayGroupTable$Group[match(as.numeric(format(Sys.Date(), 
                                                             '%j')), 
                                           sevenDayGroupTable$DOY)] - 1



firearm.desc <- trimws(c('Prohibited Use of Weapon City Limits', 
                        'Use of Dangerous Weapon', 
                        'Criminal Use Firearm 1st: Commit Violent Class B Felony', 
                        'Discharges Loaded Firearm', 
                        'Use Firearm 1st: Possess a Deadly Weapon-Loaded',
                        'Criminal Use Firearm 2nd: Possess Deadly Weapon: Loaded', 
                        'Use Firearm 1st: Display Firearm', 
                        'Criminal Use Firearm 2nd: Display Firearm'))

firearmCrimeTypes <- c("Aggravated Assault", "Robbery", "Homicide", "Rape", "Simple Assault")

#load in RPD's crime data

df <- LERMS_incidents_query(years = curr.year) %>%
    distinct(CaseNumber, FullAddress, ReportDate, Description, .keep_all = TRUE) %>%
    filter(MostSerious == 1, CaseStatusValue != 'Unfounded') %>%
    arrange(ReportDate) %>%
    mutate(CRNum = paste0(substr(CaseNumber, start = 3, stop = 5),
                          substr(CaseNumber, start = 8, stop = 13)),
           OffenseDate = as.Date(OffenseDate, format = "%Y-%m-%d"),
           ReportDate = as.Date(ReportDate, format = "%Y-%m-%d"),
           OffenseDOW = factor(OffenseDOW, 
                               levels = c("Sunday", "Monday", "Tuesday", "Wednesday",
                                   "Thursday", "Friday", "Saturday"), 
                               ordered = TRUE),
           ReportDayOfYear = as.numeric(format(ReportDate, "%j")),
           GEOBeat = factor(GEOBeat,
                            levels = unique(GEOBeat[order(substr(GEOBeat, 3, 3), 
                                                          substr(GEOBeat, 1, 2))])),
           sec = case_when(.$Section == 1 ~ "Lake", 
                           .$Section == 3 ~ "Genesee", 
                           .$Section == 5 ~ "Goodman", 
                           .$Section == 7 ~ "Clinton", 
                           .$Section == 9 ~ "Central"),
           WeaponGroup = case_when(.$WeaponIBRValue %in% c("01", "02", "03", "04", "05",
                                                         "06", "07", "08", "09", "10") ~ "Firearm",
                                   .$WeaponIBRValue == "11" ~ "Knife/Cutting Instrument",
                                   .$WeaponIBRValue == "12" ~ "Blunt Object",
                                   .$WeaponIBRValue %in% c("14", "15") ~ "Physical",
                                   TRUE ~ "Other"),
           FullAddress = unname(sapply(FullAddress, simpleCap)),
           WeaponIBRValue = as.numeric(WeaponIBRValue),
           Description = trimws(Description)) %>%
           mutate(Firearm = case_when(.$WeaponIBRValue %in% 1:10 &
                                   .$CrimeType %in% firearmCrimeTypes ~ "Firearm",
                               .$CrimeType == "Dangerous Weapons" & 
                                   .$Description %in% firearm.desc ~ "Firearm",
                               TRUE ~ "Non-Firearm")) %>%
    left_join(sevenDayGroupTable, by = c("ReportDayOfYear" = "DOY")) %>%
    select(-Date) %>%
    dplyr::rename("SevenDaysGroup" = Group) %>%
    filter(SevenDaysGroup <= curr.week) %>%
    mutate(Description = trimws(sub(x = Description, pattern = ":.*", replacement = "")))

#use beatNames to make factor levels for beats
beatNames <- df %>%
    select(GEOBeat) %>%
    unique() %>% 
    filter(! grepl(x = GEOBeat, pattern = "\\*")) %>% #remove *** as a beat name
    arrange(substr(GEOBeat, 3, 3), GEOBeat) %>%
    mutate(GEOBeat = as.factor(GEOBeat)) #this keeps *** as a factor level

CPWs <- df %>% filter(CrimeType == "Dangerous Weapons" & 
                          !trimws(Description) %in% firearm.desc &
                          as.numeric(WeaponIBRValue) < 11) %>%
    mutate(OccurFromDate = as.character(OccurFromDate)) #for table display purposes

crimes <- c('Aggravated Assault', 'Arson', 'Burglary', 'Homicide', 'Larceny', 'MV Theft', 'Rape', 'Robbery', 'Firearm')
sec <- c('Lake', 'Genesee', 'Goodman', 'Clinton', 'Central')

pal <- brewer.pal(name = "Reds", n = 9)


PropVals <- read.csv("Y:/Projects/dashboard/RPDCrimeDashboard/Objects/ProportionsAndCounts.csv", 
                     header= T)
ShootingControlLimits <- read.csv("Y:/Projects/dashboard/RPDCrimeDashboard/Objects/3YrWeightedControlLimitsShootings.csv")
ShootingProps <- read.csv("Y:/Projects/dashboard/RPDCrimeDashboard/Objects/ProportionsAndCountsShootings.csv", 
                          stringsAsFactors = FALSE)
ShootingPropsFull <- ShootingProps

histdata <- read.csv(file = "Y:/Projects/dashboard/RPDCrimeDashboard/Objects/historicaldata.csv", 
                     stringsAsFactors = FALSE, 
                     header = TRUE)

controllimits <- read.csv(file = "Y:/Projects/dashboard/RPDCrimeDashboard/Objects/3YrWeightedControlLimits.csv", 
                          header = TRUE)

controllimits <- rbind(data.frame(controllimits, Year = 2017),
                       data.frame(controllimits, Year = 2018),
                       data.frame(controllimits, Year = 2019))

mculist <- pullMCUdata()
MCUhoms <- mculist[[1]]
person <- mculist[[2]]
rm(mculist)
MCUhoms <- MCUhoms %>%
    mutate(CrimeType = "Homicide",
           DateOfEvent = as.Date(DateOfEvent, format = "%Y-%m-%d"),
           DOYofEvent = as.numeric(format(DateOfEvent, "%j")),
           YearofEvent = as.numeric(format(DateOfEvent, "%Y")),
           CaseStatus = unname(sapply(CaseStatus, simpleCap))) %>%
    filter(YearofEvent == curr.year) %>%
    dplyr::rename(sec = Section,
                  Lat = Latitude,
                  Lon = Longitude,
                  FullAddress = Address) %>%
    left_join(sevenDayGroupTable, by = c("DOYofEvent" = "DOY")) %>%
    select(-Date) %>%
    dplyr::rename("SevenDaysGroup" = Group)

personincident <- left_join(MCUhoms, person, by = "CaseNumber")

sv <- loadshootingvictims()
drops <- c("Lat", "Lon")
svjoined <- left_join(x = sv, y = df, by = c("CaseNumber" = "CRNum")) %>%
    select(-one_of(drops)) %>%
    rename(Lat = Latitude, Lon = Longitude)


```

```{r SPC}

PropValsLake <- filter(PropVals, Section == "Lake")
PropValsGenesee <- filter(PropVals, Section == "Genesee")
PropValsGoodman <- filter(PropVals, Section == "Goodman")
PropValsClinton <- filter(PropVals, Section == "Clinton")
PropValsCentral <- filter(PropVals, Section == "Central")

df.Lake <- filter(df, sec == "Lake")
df.Genesee <- filter(df, sec == "Genesee")
df.Goodman <- filter(df, sec == "Goodman")
df.Clinton <- filter(df, sec == "Clinton")
df.Central <- filter(df, sec == "Central")

firearmSPC.Lake <- SPC(crimetype = "Firearm", Prop.Vals = PropValsLake, dataf = df.Lake)
firearmSPC.Genesee <- SPC(crimetype = "Firearm", Prop.Vals = PropValsGenesee, dataf = df.Genesee)
firearmSPC.Goodman <- SPC(crimetype = "Firearm", Prop.Vals = PropValsGoodman, dataf = df.Goodman)
firearmSPC.Clinton <- SPC(crimetype = "Firearm", Prop.Vals = PropValsClinton, dataf = df.Clinton)
firearmSPC.Central <- SPC(crimetype = "Firearm", Prop.Vals = PropValsCentral, dataf = df.Central)

ShootingProps <- filter(ShootingPropsFull, Section == "Lake") #To avoid having to change the SPC function...
svSPC.Lake <- SPC(crimetype = "Shooting", dataf = filter(svjoined, sec == "Lake"))
ShootingProps <- filter(ShootingPropsFull, Section == "Genesee")
svSPC.Genesee <- SPC(crimetype = "Shooting", dataf = filter(svjoined, sec == "Genesee"))
ShootingProps <- filter(ShootingPropsFull, Section == "Goodman")
svSPC.Goodman <- SPC(crimetype = "Shooting", dataf = filter(svjoined, sec == "Goodman"))
ShootingProps <- filter(ShootingPropsFull, Section == "Clinton")
svSPC.Clinton <- SPC(crimetype = "Shooting", dataf = filter(svjoined, sec == "Clinton"))
ShootingProps <- filter(ShootingPropsFull, Section == "Central")
svSPC.Central <- SPC(crimetype = "Shooting", dataf = filter(svjoined, sec == "Central"))

homicideSPC.Lake <- SPC(crimetype = "Homicide", Prop.Vals = PropValsLake, dataf = df.Lake)
homicideSPC.Genesee <- SPC(crimetype = "Homicide", Prop.Vals = PropValsGenesee, dataf = df.Genesee)
homicideSPC.Goodman <- SPC(crimetype = "Homicide", Prop.Vals = PropValsGoodman, dataf = df.Goodman)
homicideSPC.Clinton <- SPC(crimetype = "Homicide", Prop.Vals = PropValsClinton, dataf = df.Clinton)
homicideSPC.Central <- SPC(crimetype = "Homicide", Prop.Vals = PropValsCentral, dataf = df.Central)

rapeSPC.Lake <- SPC(crimetype = "Rape", Prop.Vals = PropValsLake, dataf = df.Lake)
rapeSPC.Genesee <- SPC(crimetype = "Rape", Prop.Vals = PropValsGenesee, dataf = df.Genesee)
rapeSPC.Goodman <- SPC(crimetype = "Rape", Prop.Vals = PropValsGoodman, dataf = df.Goodman)
rapeSPC.Clinton <- SPC(crimetype = "Rape", Prop.Vals = PropValsClinton, dataf = df.Clinton)
rapeSPC.Central <- SPC(crimetype = "Rape", Prop.Vals = PropValsCentral, dataf = df.Central)

robSPC.Lake <- SPC(crimetype = "Robbery", Prop.Vals = PropValsLake, dataf = df.Lake)
robSPC.Genesee <- SPC(crimetype = "Robbery", Prop.Vals = PropValsGenesee, dataf = df.Genesee)
robSPC.Goodman <- SPC(crimetype = "Robbery", Prop.Vals = PropValsGoodman, dataf = df.Goodman)
robSPC.Clinton <- SPC(crimetype = "Robbery", Prop.Vals = PropValsClinton, dataf = df.Clinton)
robSPC.Central <- SPC(crimetype = "Robbery", Prop.Vals = PropValsCentral, dataf = df.Central)

asltSPC.Lake <- SPC(crimetype = "Aggravated Assault", Prop.Vals = PropValsLake, dataf = df.Lake)
asltSPC.Genesee <- SPC(crimetype = "Aggravated Assault", Prop.Vals = PropValsGenesee, dataf = df.Genesee)
asltSPC.Goodman <- SPC(crimetype = "Aggravated Assault", Prop.Vals = PropValsGoodman, dataf = df.Goodman)
asltSPC.Clinton <- SPC(crimetype = "Aggravated Assault", Prop.Vals = PropValsClinton, dataf = df.Clinton)
asltSPC.Central <- SPC(crimetype = "Aggravated Assault", Prop.Vals = PropValsCentral, dataf = df.Central)

burgSPC.Lake <- SPC(crimetype = "Burglary", Prop.Vals = PropValsLake, dataf = df.Lake)
burgSPC.Genesee <- SPC(crimetype = "Burglary", Prop.Vals = PropValsGenesee, dataf = df.Genesee)
burgSPC.Goodman <- SPC(crimetype = "Burglary", Prop.Vals = PropValsGoodman, dataf = df.Goodman)
burgSPC.Clinton <- SPC(crimetype = "Burglary", Prop.Vals = PropValsClinton, dataf = df.Clinton)
burgSPC.Central <- SPC(crimetype = "Burglary", Prop.Vals = PropValsCentral, dataf = df.Central)

larcSPC.Lake <- SPC(crimetype = "Larceny", Prop.Vals = PropValsLake, dataf = df.Lake)
larcSPC.Genesee <- SPC(crimetype = "Larceny", Prop.Vals = PropValsGenesee, dataf = df.Genesee)
larcSPC.Goodman <- SPC(crimetype = "Larceny", Prop.Vals = PropValsGoodman, dataf = df.Goodman)
larcSPC.Clinton <- SPC(crimetype = "Larceny", Prop.Vals = PropValsClinton, dataf = df.Clinton)
larcSPC.Central <- SPC(crimetype = "Larceny", Prop.Vals = PropValsCentral, dataf = df.Central)

```

Firearm Crime {data-navmenu="Violent Crime"} 
======================================================================

> Firearm Crime

Column
------------------------------------------------------------------------------

### Section comparison

```{r firearmtable}
#Check to make sure this year's firearm homicides are in the firearm data
MCUhoms$CaseNumber <- paste0("20", 
                              substr(MCUhoms$CaseNumber, 1, 3),
                              "00", 
                              substr(MCUhoms$CaseNumber, 4, 9))
firearmhoms <- MCUhoms %>% 
    filter(YearofEvent == curr.year, WeaponType == "Firearm")
if(any(! firearmhoms$CaseNumber %in% filter(df, Firearm == "Firearm"))){
    cat("There are firearm homicides that do not appear in the firearm data due to LERMS issues.")
}

tab <- data.frame(Sections = sec,
                  Counts = c(firearmSPC.Lake[[4]],
                             firearmSPC.Genesee[[4]],
                             firearmSPC.Goodman[[4]],
                             firearmSPC.Clinton[[4]],
                             firearmSPC.Central[[4]]),
                  RiskOfRed = c(firearmSPC.Lake[[2]],
                               firearmSPC.Genesee[[2]],
                               firearmSPC.Goodman[[2]],
                               firearmSPC.Clinton[[2]],
                               firearmSPC.Central[[2]]),
                  ChanceOfGreen = c(firearmSPC.Lake[[3]],
                                   firearmSPC.Genesee[[3]],
                                   firearmSPC.Goodman[[3]],
                                   firearmSPC.Clinton[[3]],
                                   firearmSPC.Central[[3]]))

datatable(tab,
          rownames = FALSE,
          colnames = c("Sections", 
                       "YTD Totals", 
                       "% chance of exceeding upper action limit", 
                       "% chance of beating lower action limit"),
          options = list(dom = 'tf',
                         columnDefs = list(list(className = 'dt-right', targets = 0:3))))
```

Column
------------------------------------------------------------------------------

### Map

```{r Firearmcrimemap}

firearmsJSON <- daddyJSON

firearmdiff <- data_frame("Section" = sec,
                          "Difference" = c(firearmSPC.Lake[[2]] - firearmSPC.Lake[[3]],
                                           firearmSPC.Genesee[[2]] - firearmSPC.Genesee[[3]],
                                           firearmSPC.Goodman[[2]] - firearmSPC.Goodman[[3]],
                                           firearmSPC.Clinton[[2]] - firearmSPC.Clinton[[3]],
                                           firearmSPC.Central[[2]] - firearmSPC.Central[[3]])) %>%
    mutate(fillOpacity = abs(Difference / 100),
           fillColor = case_when(.$Difference > 0 ~ "Red",
                             .$Difference < 0 ~ "Green",
                             TRUE ~ "White"))
firearmdiff <- firearmdiff[match(lapply(firearmsJSON$features, function(x) x$properties$Section) %>% 
                                     unlist(), 
                                 firearmdiff$Section),]

firearmsJSON$features <- lapply(firearmsJSON$features, function(x) {
    x$properties$style <- list(
        fillColor = firearmdiff$fillColor[which(firearmdiff$Section == x$properties$Section)],
        fillOpacity = firearmdiff$fillOpacity[which(firearmdiff$Section == x$properties$Section)]
    )
    x
})

links <- data_frame(Section = sec,
                    link = c('<a href="file://rpdfs.cor.local/mcac$/MCAC Operations/Crime Dashboards/LakeCrimeDashboard.html#firearm-crime-1">Lake Section Dashboard</a>', 
                             '<a href="file://rpdfs.cor.local/mcac$/MCAC Operations/Crime Dashboards/GeneseeCrimeDashboard.html#firearm-crime-1">Genesee Section Dashboard</a>', 
                             '<a href="file://rpdfs.cor.local/mcac$/MCAC Operations/Crime Dashboards/GoodmanCrimeDashboard.html#firearm-crime-1">Goodman Section Dashboard</a>', 
                             '<a href="file://rpdfs.cor.local/mcac$/MCAC Operations/Crime Dashboards/ClintonCrimeDashboard.html#firearm-crime-1">Clinton Section Dashboard</a>', 
                             '<a href="file://rpdfs.cor.local/mcac$/MCAC Operations/Crime Dashboards/CentralCrimeDashboard.html#firearm-crime-1">Central Section Dashboard</a>'))


firearmsJSON$features <- lapply(firearmsJSON$features, function(x) {
    
    x$properties$popup = links$link[which(links$Section == x$properties$Section)]
    x
})

citymap %>%
    addGeoJSON(
        firearmsJSON
        ) %>%
    addGeoJSONv2(
        firearmsJSON,
        fillOpacity = 0,
        popupProperty = "popup",
        labelProperty = "Section"
        )

```


Shooting Victims{data-navmenu="Violent Crime"} 
======================================================================

> Shooting Victims

Column
------------------------------------------------------------------------------

### Section comparison

Column
------------------------------------------------------------------------------

### Map

```{r svmap}

overviewmapfunc(daddyJSON = daddyJSON,
                lakeSPC = svSPC.Lake,
                geneseeSPC = svSPC.Genesee,
                goodmanSPC = svSPC.Goodman,
                clintonSPC = svSPC.Clinton,
                centralSPC = svSPC.Central,
                linkhash = "#shooting-victims-1",
                citymap = citymap,
                sec = sec)

```

Robbery {data-navmenu="Violent Crime"} 
======================================================================

> Robbery

Column
------------------------------------------------------------------------------

### Section comparison

Column
------------------------------------------------------------------------------

### Map

```{r robmap}

overviewmapfunc(daddyJSON = daddyJSON,
                lakeSPC = robSPC.Lake,
                geneseeSPC = robSPC.Genesee,
                goodmanSPC = robSPC.Goodman,
                clintonSPC = robSPC.Clinton,
                centralSPC = robSPC.Central,
                linkhash = "#robbery-1",
                citymap = citymap,
                sec = sec)

```

Aggravated Assaults {data-navmenu="Violent Crime"} 
======================================================================

> Aggravated Assaults

Column
------------------------------------------------------------------------------

### Section comparison

Column
------------------------------------------------------------------------------

### Map

```{r asltmap}

overviewmapfunc(daddyJSON = daddyJSON,
                lakeSPC = asltSPC.Lake,
                geneseeSPC = asltSPC.Genesee,
                goodmanSPC = asltSPC.Goodman,
                clintonSPC = asltSPC.Clinton,
                centralSPC = asltSPC.Central,
                linkhash = "#aggravated-assault-1",
                citymap = citymap,
                sec = sec)

```


Homicide {data-navmenu="Violent Crime"} 
======================================================================

> Homicide

Column
------------------------------------------------------------------------------

### Section comparison

Column
------------------------------------------------------------------------------

### Map

```{r hommap}

overviewmapfunc(daddyJSON = daddyJSON,
                lakeSPC = homicideSPC.Lake,
                geneseeSPC = homicideSPC.Genesee,
                goodmanSPC = homicideSPC.Goodman,
                clintonSPC = homicideSPC.Clinton,
                centralSPC = homicideSPC.Central,
                linkhash = "#homicide-1",
                citymap = citymap,
                sec = sec)

```

Rape {data-navmenu="Violent Crime"} 
======================================================================

> Rape

Column
------------------------------------------------------------------------------

### Section comparison

Column
------------------------------------------------------------------------------

### Map

```{r rapemap}

overviewmapfunc(daddyJSON = daddyJSON,
                lakeSPC = rapeSPC.Lake,
                geneseeSPC = rapeSPC.Genesee,
                goodmanSPC = rapeSPC.Goodman,
                clintonSPC = rapeSPC.Clinton,
                centralSPC = rapeSPC.Central,
                linkhash = "#rape-1",
                citymap = citymap,
                sec = sec)

```

Burglary {data-navmenu="Property Crime"} 
======================================================================

> Burglary

Column
------------------------------------------------------------------------------

### Section comparison

Column
------------------------------------------------------------------------------

### Map

```{r burgmap}

overviewmapfunc(daddyJSON = daddyJSON,
                lakeSPC = burgSPC.Lake,
                geneseeSPC = burgSPC.Genesee,
                goodmanSPC = burgSPC.Goodman,
                clintonSPC = burgSPC.Clinton,
                centralSPC = burgSPC.Central,
                linkhash = "#burglary-1",
                citymap = citymap,
                sec = sec)

```

Larceny {data-navmenu="Property Crime"} 
======================================================================

> Larceny

Column
------------------------------------------------------------------------------

### Section comparison

Column
------------------------------------------------------------------------------

### Map

```{r larcmap}

overviewmapfunc(daddyJSON = daddyJSON,
                lakeSPC = larcSPC.Lake,
                geneseeSPC = larcSPC.Genesee,
                goodmanSPC = larcSPC.Goodman,
                clintonSPC = larcSPC.Clinton,
                centralSPC = larcSPC.Central,
                linkhash = "#larceny-1",
                citymap = citymap,
                sec = sec)

```


